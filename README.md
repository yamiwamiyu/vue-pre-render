# vue-pre-render

<hr />
Crawl a SPA (Single-Page Application) and generate pre-rendered content

## Feature

1.  Configuration **Simple**
2.  Rendering **Fast**
3.  Support **webpack** and **cmd** modes


## Installation


```
npm i @yamiwamiyu/vue-pre-render
```

## Document
#### Configuration

| field       | description                                                                                                                              | default   |
|----------|---------------------------------------------------------------------------------------------------------------------------------|-------|
| chrome   | When you are worried about the inconsistency between the pre rendered effect and the browsing effect of your local browser, you can use the browser installed locally to pre render. For example, under Windows, this value is like C:/Program Files (x86)/Google/Chrome/Application/chrome.exe |       |
| headless | Whether to hide the browser during pre rendering                                                                                                                     | false |
| dist     | Directory generated by VUE project execution `npm run build`                                                                                                                     | dist  |
| serve    | Pre rendering requires an Express server. This is the port of the server. If this port is occupied, please change an available port                                                                             | 21644 |
| [seo](#seo)      | SEO configuration applicable to all pre rendered  pages. Directly modify your public/index.html page to achieve the same effect                                                                                                             |       |
| [pages(*)](#router)    | Routes for all pages requiring pre rendering                                                                                                                 |       |

#### SEO

| field          | description                                                                                     |
|-------------|----------------------------------------------------------------------------------------|
| title       | Title of html  page                                                                             |
| keywords    | `<meta name="keywords" content="{value}">`<br>It can be an array, such as ['Keyword1', 'Keyword2']<br>or a string, such as 'Keyword1, Keyword2' |     |
| description | `<meta name="keywords" content="{value}">`, Description of the website                                         |
| meta        | More meta tags, such as [{name:'MetaName ', content:'MetaContent'}]                                   |

#### Router

| field     | description                                                               |
|--------|------------------------------------------------------------------|
| url(*)    | The address of the routing page. For example, '/' or '/index'<br>You can configure the routing with parameters, such as '/index/param' (generate '/index/param.html') or<br>'/index?key=value' (generate '/index.html')       |
| output | The output path of the static page. The default output is consistent with the url. For example, '/' or '/index' will output '/index.html'. Set 'my_index' can be output as 'my_index.html' |
| [seo](#seo)    | Routes for current page pre rendering                                                  |

```
[
  {
    // url query example

    // default output: index.html
    url: '/index?lang=en',
    // result output: index_en.html
    output: 'index_en',
  },
  {
    // vue router with params example
    // { path: '/pre/:param', component: () => import('./components/pre') }

    // default output: /pre/parameter.html
    url: '/pre/parameter',
    // result output: /pre.html
    output: '/pre',
  }
]
```


## VUE Router please use `createWebHistory`

```
import { createApp } from 'vue'
import { createRouter, createWebHistory } from 'vue-router'
import App from './App.vue';

createApp(App).use(
  createRouter({
    // please use createWebHistory
    history: createWebHistory(process.env.BASE_URL),
    [
      { path: '/', component: () => import('./components/index') },
      { path: '/pre/:param', component: () => import('./components/pre') },
      { path: '/dir/indir', component: () => import('./components/dir/indir') },
      { path: '/nopre', component: () => import('./components/nopre') },
    ]
  })
).mount('#app')
```


## webpack Usage

Configure the following contents in the configuration file. In the VUE3 project, the general configuration file is called **vue.config.js**, and the contents are roughly as follows

```
const { defineConfig } = require('@vue/cli-service')
const { VuePreRender } = require('@yamiwamiyu/vue-pre-render')

module.exports = defineConfig({
  // ...
  //publicPath: "/", // Please don't use "./"
  
  configureWebpack: {
    plugins: [new VuePreRender({
      headless: true,
      pages: ['/', '/nopre', '/dir/indir?param=value', 
        {
          url: '/pre/abc',
          output: '/pre',
          seo: {
            title: "Pre Title",
            keywords: ["Pre Render", "Pre-render"],
            description: "Pre page is a test page",
            meta: [
              { name: 'pre', content: 'pre-render' },
            ]
          }
        }
      ],
    })],
  }
})
```
    
    
## cmd Usage

1.  Create a new configuration file, pre.config.json, in the project root directory. The configuration contents are as follows

```
{
  "headless": false,
  "pages": ["/", "/pre", "/dir/indir", "/nopre"]
}
```

2.  When you need to pre render (usually after `npm run build`), execute the following command

```
node node_modules/@yamiwamiyu/vue-pre-render/cmd.js pre pre.config.json
```

## Demo

1.  Rendering
```
Connect chrome success!
Express serve launched! http://localhost:21644 in dist
page redirected! /nopre -> /
render complete! /pre
render complete! /dir/indir
render complete! /
Pre rendering is complete!
```

`page redirected! /nopre -> /` This means that the page url is redirected from "/pre" to "/"<br>The reason for this is that, for example, the page needs to be logged in to display, but it jumps to the login page because there is no login<br>Although '/nopre.html' is finally generated, the content of '/nopre.html' is the original '/index.html' content


2.  Result
- index.html
- pre.html
- nopre.html
- dir/
  - indir.html